<!DOCTYPE html>
<html>
  <head>
    <%- include('../partials/head'); %>
    <title><%= title %></title>
  </head>
  <body>
    <!-- Navbar -->
    <%- include('../partials/header'); %>

    <!-- Contents -->
    <div class="uk-section uk-section-default">
      <div class="uk-container">
        <div class="uk-margin-large">
          <h2 class="uk-width-medium uk-h2">Product</h2>
          <div class="uk-divider-small"></div>
          <% if (product.length === 0) { %>
            <div class="uk-child-width-1-1">
              <div class="text-center">There is no product yet.</div>
            </div>
          <% } else { %>
            <div class="uk-grid uk-grid-small uk-child-width-1-2 uk-child-width-1-3@m uk-child-width-1-4@l uk-grid-match" data-uk-grid>
              <!-- items -->
              <% for (let i = 0; i < product.length; i++) { %>
                <div>
                  <div class="uk-card uk-card-default uk-card-small">
                    <a href="product/<%= product[i].id %>">
                      <div class="uk-card-media-top">
                        <img src="<%= product[i].thumbnail %>" alt="test picture">
                      </div>
                      <div class="uk-card-body">
                        <h4 class="uk-h4 uk-margin-remove-bottom"><%= product[i].name %></h4>
                        <%
                        <!-- insert commas every three digits to price -->
                          function commify(n) {
                            var reg = /(^[+-]?\d+)(\d{3})/;
                            n += '';
  
                            while (reg.test(n))
                              n = n.replace(reg, '$1' + ',' + '$2');
  
                            return n;
                          }
                        %>
                        <p class="uk-text-meta uk-margin-remove-top">â‚©<%= commify(product[i].price) %></p>
                      </div>
                    </a>
                  </div>
                </div>
              <% } %>
            </div>
          <% } %>
          <% if (currentUser && currentUser.admin) { %>
            <p uk-margin>
              <a class="uk-button uk-button-primary" href="product/new">New Product</a>
            </p>
          <% } %>
        </div>
      </div>
    </div>
  </body>
</html>